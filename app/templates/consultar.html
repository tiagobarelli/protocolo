{% extends "base.html" %}
{% block title %}Consultar Protocolo - Sistema Interno{% endblock %}
{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/consultar.css') }}">
{% endblock %}
{% block content %}
<div class="overlay" id="overlay"><div class="spinner"></div></div>
<div class="consultar-container">
  <div id="searchView">
    <a href="{{ url_for('main.index') }}" class="back-link"><i class="ph ph-arrow-left"></i> Voltar ao menu</a>
    <div class="search-card">
      <div class="search-header">
        <h1><i class="ph ph-magnifying-glass" style="color: var(--accent);"></i> Consultar Protocolo</h1>
        <p>Busque por número do protocolo, nome do interessado ou documento.</p>
      </div>
      <div class="search-box-wrapper">
        <input type="text" id="termoBusca" placeholder="Ex: 2026-001234 ou CPF/Nome" autofocus>
        <button class="btn btn-primary" onclick="buscarProtocolo()">Buscar</button>
      </div>
      <div id="searchMsg" class="msg-box"></div>
      <div class="results" id="resultados"></div>
    </div>
  </div>
  <div id="receiptView">
    <a href="#" class="back-link" onclick="voltarBusca(); return false;"><i class="ph ph-arrow-left"></i> Voltar à consulta</a>
    <div class="receipt-paper">
      <div class="print-header">
        <h2>Tabelião de Notas e de Protesto de Letras e Títulos de Itápolis-SP</h2>
        <p>Rua Barão do Rio Branco, n. 378 – Centro, Itápolis-SP (CEP 14900-057)</p>
        <p>contato@cartorioitapolis.com.br | (16) 3273 9448</p>
        <p>www.cartorioitapolis.com.br</p>
      </div>
      <div class="protocol-title">PROTOCOLO – <span id="recProtocoloTitulo"></span></div>
      <table class="simple-table handwrite-table">
        <tr><td class="label-col">LIVRO</td><td class="input-col"></td><td class="label-col">PÁGINA</td><td class="input-col"></td></tr>
      </table>
      <div class="info-grid">
        <div class="info-item full-width"><span class="info-label">Interessado</span><span class="info-value" id="recInteressado"></span></div>
        <div class="info-item"><span class="info-label">CPF / CNPJ</span><span class="info-value" id="recDocumento"></span></div>
        <div class="info-item"><span class="info-label">Data de Entrada</span><span class="info-value" id="recData"></span></div>
        <div class="info-item full-width" id="recAdvogadoBox" style="display:none"><span class="info-label">Advogado Assessor</span><span class="info-value" id="recAdvogado"></span></div>
        <div class="info-item full-width"><span class="info-label">Serviço Solicitado</span><span class="info-value" id="recServico"></span></div>
        <div class="info-item"><span class="info-label">Responsável</span><span class="info-value" id="recResponsavel"></span></div>
        <div class="info-item"><span class="info-label">Status Atual</span><span class="info-value" id="recStatus"></span></div>
        <div class="info-item" id="recTelefoneBox" style="display:none"><span class="info-label">Telefone</span><span class="info-value" id="recTelefone"></span></div>
        <div class="info-item" id="recEmailBox" style="display:none"><span class="info-label">E-mail</span><span class="info-value" id="recEmail"></span></div>
      </div>
      <div class="info-item full-width" id="recDepositoBox" style="display:none; margin-bottom:20px;"><span class="info-label">Depósito Prévio</span><span class="info-value" id="recDeposito"></span></div>
      <div class="details-box" id="recDetalhamentosBox" style="display:none"><span class="info-label">Detalhamentos / Observações</span><div class="details-content" id="recDetalhamentos"></div></div>
      <table class="simple-table notes-table" style="margin-top: 30px;"><thead><tr><th>ANOTAÇÕES</th></tr></thead><tbody><tr><td></td></tr></tbody></table>
    </div>
    <div class="receipt-actions">
      <button class="btn btn-primary" onclick="window.print()"><i class="ph ph-printer"></i> Imprimir</button>
      <button class="btn btn-secondary" onclick="voltarBusca()"><i class="ph ph-magnifying-glass"></i> Nova Consulta</button>
    </div>
  </div>
</div>
{% endblock %}
{% block extra_js %}
<script src="{{ url_for('static', filename='vendor/marked/marked.umd.js') }}"></script>
<script src="{{ url_for('static', filename='js/consultar.js') }}"></script>
{% endblock %}
